(()=>{var a={};a.id=721,a.ids=[721],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:a=>{"use strict";a.exports=require("path")},4870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5681:()=>{},6404:(a,b,c)=>{"use strict";c.d(b,{Q7:()=>o,HD:()=>n,Ts:()=>p,eF:()=>m});let d=require("sqlite3");var e=c.n(d),f=c(3873),g=c.n(f),h=c(9021);let i=g().join(process.cwd(),"data","site.db"),j=null,k=!1;async function l(){return j||(j=await new Promise(async(a,b)=>{try{await h.promises.mkdir(g().dirname(i),{recursive:!0});let c=new(e()).Database(i,d=>{d?b(d):a(c)})}catch(a){b(a)}}))}function m(a,b=[]){return new Promise(async(c,d)=>{(await l()).run(a,b,function(a){a?d(a):c()})})}function n(a,b=[]){return new Promise(async(c,d)=>{(await l()).get(a,b,function(a,b){a?d(a):c(b)})})}function o(a,b=[]){return new Promise(async(c,d)=>{(await l()).all(a,b,function(a,b){a?d(a):c(b)})})}async function p(){k||(await m("PRAGMA journal_mode = WAL"),await m("CREATE TABLE IF NOT EXISTS gifts (id INTEGER PRIMARY KEY, name TEXT NOT NULL, image TEXT, category TEXT, claimed INTEGER NOT NULL DEFAULT 0, claimedBy TEXT, claimedByPhoto TEXT)"),await m("CREATE TABLE IF NOT EXISTS rsvps (id INTEGER PRIMARY KEY, name TEXT NOT NULL, guests INTEGER NOT NULL, message TEXT, createdAt TEXT NOT NULL)"),await m("CREATE TABLE IF NOT EXISTS supporters (id INTEGER PRIMARY KEY, name TEXT NOT NULL, photo TEXT, receipt TEXT, createdAt TEXT NOT NULL)"),k=!0)}},6439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},7551:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>N,patchFetch:()=>M,routeModule:()=>I,serverHooks:()=>L,workAsyncStorage:()=>J,workUnitAsyncStorage:()=>K});var d={};c.r(d),c.d(d,{DELETE:()=>H,GET:()=>F,POST:()=>G,runtime:()=>D});var e=c(6836),f=c(6153),g=c(3744),h=c(882),i=c(8928),j=c(2033),k=c(3290),l=c(261),m=c(5534),n=c(2852),o=c(3228),p=c(6239),q=c(761),r=c(5883),s=c(5029),t=c(8034),u=c(6439),v=c(5072),w=c(4493),x=c(9288),y=c.n(x),z=c(9021),A=c(3873),B=c.n(A),C=c(6404);let D="nodejs",E=B().join(process.cwd(),"public","uploads","supporters");async function F(){await (0,C.Ts)();let a=(await (0,C.Q7)("SELECT id, name, photo, receipt, createdAt FROM supporters ORDER BY id")).map(a=>({id:Number(a.id),name:String(a.name||""),photo:a.photo?String(a.photo):void 0,receipt:a.receipt?String(a.receipt):void 0,createdAt:String(a.createdAt||"")}));return w.NextResponse.json(a)}async function G(a){let b=a.headers.get("content-type")||"";await (0,C.Ts)();let c=await (0,C.HD)("SELECT MAX(id) AS max FROM supporters"),d=(c?.max||0)+1;async function e(a,b){await z.promises.mkdir(b,{recursive:!0}),(a.type||"").toLowerCase();let c=await a.arrayBuffer(),d=Buffer.from(c),e=a.name.replace(/[^a-zA-Z0-9._-]/g,"_"),f=`${Date.now()}-${e}`,g=B().join(b,f);try{let a=y()(d,{animated:!0}).rotate(),c=await a.jpeg({quality:82}).toBuffer();f=`${Date.now()}-${e.replace(/\.[^.]+$/,"")}.jpg`,g=B().join(b,f),await z.promises.writeFile(g,c)}catch{await z.promises.writeFile(g,d)}return f}if(b.includes("multipart/form-data")){let b=await a.formData(),c=String(b.get("supportName")||b.get("name")||""),f=b.get("supportPhoto")||b.get("photo"),g=b.get("receipt")||b.get("comprovante"),h="",i="";if(f&&"object"==typeof f&&f.size){let a=await e(f,E);h=`/uploads/supporters/${a}`}if(g&&"object"==typeof g&&g.size){let a=await e(g,E);i=`/uploads/supporters/${a}`}let j={id:d,name:c,photo:h||void 0,receipt:i||void 0,createdAt:new Date().toISOString()};return await (0,C.eF)("INSERT INTO supporters (id, name, photo, receipt, createdAt) VALUES (?, ?, ?, ?, ?)",[j.id,j.name,j.photo||null,j.receipt||null,j.createdAt]),w.NextResponse.json(j,{status:201})}let f=await a.json().catch(()=>({})),g={id:d,name:String(f?.name||""),photo:f?.photo?String(f.photo):void 0,receipt:f?.receipt?String(f.receipt):void 0,createdAt:new Date().toISOString()};return await (0,C.eF)("INSERT INTO supporters (id, name, photo, receipt, createdAt) VALUES (?, ?, ?, ?, ?)",[g.id,g.name,g.photo||null,g.receipt||null,g.createdAt]),w.NextResponse.json(g,{status:201})}async function H(a){let b=await a.json().catch(()=>({})),c=Number(b?.id||0);return c?await (0,C.HD)("SELECT id FROM supporters WHERE id = ?",[c])?(await (0,C.eF)("DELETE FROM supporters WHERE id = ?",[c]),w.NextResponse.json({ok:!0})):w.NextResponse.json({error:"not_found"},{status:404}):w.NextResponse.json({error:"invalid_id"},{status:400})}let I=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/supporters/route",pathname:"/api/supporters",filename:"route",bundlePath:"app/api/supporters/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"C:\\Users\\Alessandro\\Desktop\\Projetos\\site_casamento\\app\\api\\supporters\\route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:J,workUnitAsyncStorage:K,serverHooks:L}=I;function M(){return(0,g.patchFetch)({workAsyncStorage:J,workUnitAsyncStorage:K})}async function N(a,b,c){I.isDev&&(0,h.addRequestMeta)(a,"devRequestTimingInternalsEnd",process.hrtime.bigint());let d="/api/supporters/route";"/index"===d&&(d="/");let e=await I.prepare(a,b,{srcPage:d,multiZoneDraftMode:!1});if(!e)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:g,params:w,nextConfig:x,parsedUrl:y,isDraftMode:z,prerenderManifest:A,routerServerContext:B,isOnDemandRevalidate:C,revalidateOnlyGenerated:D,resolvedPathname:E,clientReferenceManifest:F,serverActionsManifest:G}=e,H=(0,l.normalizeAppPath)(d),J=!!(A.dynamicRoutes[H]||A.routes[E]),K=async()=>((null==B?void 0:B.render404)?await B.render404(a,b,y,!1):b.end("This page could not be found"),null);if(J&&!z){let a=!!A.routes[E],b=A.dynamicRoutes[H];if(b&&!1===b.fallback&&!a){if(x.experimental.adapterPath)return await K();throw new u.NoFallbackError}}let L=null;!J||I.isDev||z||(L="/index"===(L=E)?"/":L);let M=!0===I.isDev||!J,N=J&&!M;G&&F&&(0,j.setReferenceManifestsSingleton)({page:d,clientReferenceManifest:F,serverActionsManifest:G,serverModuleMap:(0,k.createServerModuleMap)({serverActionsManifest:G})});let O=a.method||"GET",P=(0,i.getTracer)(),Q=P.getActiveScopeSpan(),R={params:w,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!x.experimental.authInterrupts},cacheComponents:!!x.cacheComponents,supportsDynamicResponse:M,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:x.cacheLife,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>I.onRequestError(a,b,d,B)},sharedContext:{buildId:g}},S=new m.NodeNextRequest(a),T=new m.NodeNextResponse(b),U=n.NextRequestAdapter.fromNodeNextRequest(S,(0,n.signalFromNodeResponse)(b));try{let e=async a=>I.handle(U,R).finally(()=>{if(!a)return;a.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let c=P.getRootSpanAttributes();if(!c)return;if(c.get("next.span_type")!==o.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${c.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=c.get("next.route");if(e){let b=`${O} ${e}`;a.setAttributes({"next.route":e,"http.route":e,"next.span_name":b}),a.updateName(b)}else a.updateName(`${O} ${d}`)}),g=!!(0,h.getRequestMeta)(a,"minimalMode"),j=async h=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!g&&C&&D&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let d=await e(h);a.fetchMetrics=R.renderOpts.fetchMetrics;let i=R.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=R.renderOpts.collectedTags;if(!J)return await (0,q.I)(S,T,d,R.renderOpts.pendingWaitUntil),null;{let a=await d.blob(),b=(0,r.toNodeOutgoingHttpHeaders)(d.headers);j&&(b[t.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==R.renderOpts.collectedRevalidate&&!(R.renderOpts.collectedRevalidate>=t.INFINITE_CACHE)&&R.renderOpts.collectedRevalidate,e=void 0===R.renderOpts.collectedExpire||R.renderOpts.collectedExpire>=t.INFINITE_CACHE?void 0:R.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:d.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:e}}}}catch(b){throw(null==f?void 0:f.isStale)&&await I.onRequestError(a,b,{routerKind:"App Router",routePath:d,routeType:"route",revalidateReason:(0,p.c)({isStaticGeneration:N,isOnDemandRevalidate:C})},B),b}},l=await I.handleResponse({req:a,nextConfig:x,cacheKey:L,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:D,responseGenerator:k,waitUntil:c.waitUntil,isMinimalMode:g});if(!J)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});g||b.setHeader("x-nextjs-cache",C?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),z&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,r.fromNodeOutgoingHttpHeaders)(l.value.headers);return g&&J||m.delete(t.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,s.getCacheControlHeader)(l.cacheControl)),await (0,q.I)(S,T,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};Q?await j(Q):await P.withPropagatedContext(a.headers,()=>P.trace(o.BaseServerSpan.handleRequest,{spanName:`${O} ${d}`,kind:i.SpanKind.SERVER,attributes:{"http.method":O,"http.target":a.url}},j))}catch(b){if(b instanceof u.NoFallbackError||await I.onRequestError(a,b,{routerKind:"App Router",routePath:H,routeType:"route",revalidateReason:(0,p.c)({isStaticGeneration:N,isOnDemandRevalidate:C})}),J)throw b;return await (0,q.I)(S,T,new Response(null,{status:500})),null}}},8833:()=>{},9021:a=>{"use strict";a.exports=require("fs")},9288:a=>{"use strict";a.exports=require("sharp")},9294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[559,826],()=>b(b.s=7551));module.exports=c})();